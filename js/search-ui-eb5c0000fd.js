window.addEventListener("load",function(){function e(){var e=document.createElement("span");return e.className="page-omit",e.textContent="...",e}function t(e){getClass("search-result-list")[0].innerHTML="",p(),e.forEach(function(e){var t=document.createElement("li");t.className="search-result-item";var a='<div class="result-title"><a href="'+e.uri+'" class="result-link">'+(""==e.title?e.uri:e.title)+'</a></div><div class="result-content">'+e.content+"</div>";t.innerHTML=a,[].slice.call(t.getElementsByClassName("result-content")[0].getElementsByTagName("a"),0).forEach(function(e){e.setAttribute("target","_self"),e.setAttribute("href","javascript:;")}),getClass("search-result-list")[0].appendChild(t)}),getClass("page-number").forEach(function(e){e.addEventListener("click",function(){l=parseInt(this.id.replace("page-","")),f(n,l)})}),u(n)}var a,s,n=getQueryStringByName("keyword"),l=1,r={};getClass("search-input")[0].value=n;var c=getClass("searchbar")[0];c.click(),addClass(getClass("mask")[0],"fadeHide");var i=getClass("search-edge"),o=0,d=setInterval(function(){for(var e=0;e<i.length;e++){var t=(e+o)%i.length;i[e].className="search-edge",addClass(i[e],"search-edge-"+t)}o++},1e3),g=function(e,t){clearInterval(d),i.forEach(function(e,t){addClass(e,"search-failed"),e.textContent="CAN NOT FIND"}),addClass(getClass("search-tips-text")[0],"search-failed-text"),e?(getClass("search-header")[0].innerHTML="“<em>"+e+"</em>”的搜索结果",getClass("search-tips-text")[0].innerHTML="抱歉，未找到“<em>"+e+"</em>”的相关结果，请尝试其他关键词搜索"):(getClass("search-header")[0].innerHTML="“<em>"+n+"</em>”的搜索结果",getClass("search-tips-text")[0].textContent="抱歉，由于网络原因搜索失败，请稍后尝试搜索。"),getClass("searching")[0].style.display="block",getClass("search-result")[0].style.display="none",getClass("scale-finding")[0].style.display="none",getClass("scale-failed")[0].style.display="block"},u=function(){clearInterval(d),getClass("search-header")[0].innerHTML="“<em>"+n+"</em>”的搜索结果，共"+s+"个",getClass("searching")[0].style.display="none",getClass("search-result")[0].style.display="block"},m=getClass("pages")[0],p=function(){m.innerHTML="";for(var t=0;t<a;t++){var s=t+1,n=document.createElement("span");n.className="page-number",n.id="page-"+s,s===l&&(n.className="page-number page-current"),n.textContent=s,m.appendChild(n)}if(l<7&&a>10){for(var r=l+2<7?7:l+2;r<a;r++)m.removeChild(document.getElementById("page-"+r));m.insertBefore(e(),document.getElementById("page-"+a))}if(l>6&&l<a-2&&a>10){for(var c=4;c<l-1;c++)m.removeChild(document.getElementById("page-"+c));m.insertBefore(e(),document.getElementById("page-"+(l-1)));for(var i=l+2;i<a;i++)m.removeChild(document.getElementById("page-"+i));m.insertBefore(e(),document.getElementById("page-"+a))}if(l>a-3&&a>10){for(var o=6;o<l-1;o++)m.removeChild(document.getElementById("page-"+o));m.insertBefore(e(),document.getElementById("page-"+(l-1)))}l===a?addClass(getClass("page-next")[0],"page-gray"):removeClass(getClass("page-next")[0],"page-gray"),1===l?addClass(getClass("page-pre")[0],"page-gray"):removeClass(getClass("page-pre")[0],"page-gray")};getClass("page-next")[0].addEventListener("click",function(){l++,l>a||f(n,l)}),getClass("page-pre")[0].addEventListener("click",function(){l--,l<1||f(n,l)});var f=function(e,n){return r[n]?(t(r[n]),void(document.body.scrollTop=0)):void ajax({url:"/search?keyword="+e+"&page="+n,type:"get",success:function(l,c){if(0==l.code){if(0==l.total)return g(e),!1;var i=setTimeout(function(){var e=l.hits;s=l.total,r[n]=e,a=Math.ceil(s/10),t(e),clearTimeout(i),document.body.scrollTop=0},1e3)}else g(null,l.message),document.body.scrollTop=0},failed:function(e){g(null,e)}})};f(n,l)});